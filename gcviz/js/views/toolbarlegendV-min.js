(function(){define(["gcviz-vm-tblegend","dijit/TitlePane","gcviz-i18n"],function(d,b,c){var a;a=function(g){var i,f=g.toolbarlegend,e=g.mapframe.id,j,h="";j=new b({id:"tbleg"+e,title:c.getDict("%toolbarlegend-name"),content:'<div class="gcviz-tbleg-content gcviz-tbcontent"></div>',open:f.expand});g.find(".gcviz-tbholder").append(j.domNode);j.startup();j.domNode.getElementsByClassName("dijitTitlePaneTitleFocus")[0].setAttribute("tabindex","0");i=g.find(".gcviz-tbleg-content");h+='<div id="legendDiv'+e+'" data-bind="foreach: theArray">';h+='<ul id="serviceList" >';h+="<li>";h+='<input type="checkbox" data-bind="click: $root.changeServiceVisibility, attr: { title: $root.tpVisible, checked:visibility.visible, hidden: visibility.control }"/>';h+='<span data-bind="text: label.value"></span>';h+='<div data-bind="HorizontalSliderDijit: { widget: $root.HorizontalSlider, max:opacity.value }, attr: { hidden: opacity.slider }"></div>';h+='<ul id="layerList" data-bind="foreach: layers">';h+="<li>";h+='<input type="checkbox" data-bind="event: { change: $root.changeLayerVisibility, click: $root.changeLayerVisibility }, attr: { title: $root.tpVisible, checked:visibility.check, hidden: visibility.value, value:id }"/>';h+='<span data-bind="text: label.value"></span>';h+='<div data-bind="HorizontalSliderDijit: { widget:  $root.HorizontalSlider, max:opacity.value }, attr:{ hidden: opacity.slider }"></div>';h+="</li></ul>";h+="</li></ul></div>";i.append(h);return(d.initialize(i,e,f))};return{initialize:a}})}).call(this);